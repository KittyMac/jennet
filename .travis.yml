language: c

branches:
  only:
    - master

sudo: required

addons:
  apt:
    sources:
    - llvm-toolchain-precise-3.8
    - ubuntu-toolchain-r-test
    packages:
    - gcc-4.9
    - g++-4.9
    - build-essential
    - zlib1g-dev
    - libncurses5-dev
    - libssl-dev
    - llvm-3.8
    - llvm-3.8-dev

install:
  - if [ "${TRAVIS_OS_NAME}" = "linux" ];
    then
      export CC="gcc-4.9";
      export CXX="g++-4.9";
      wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre2-10.21.tar.bz2;
      tar -xjvf pcre2-10.21.tar.bz2;
      cd pcre2-10.21 && ./configure --prefix=/usr && make && sudo make install;
      cd -;
    fi;

before_script:
  - git clone https://github.com/ponylang/ponyc
  - cd ponyc
  - make config=release
  - export PATH=$PATH:$PWD/build/release/
  - cd ..

script: ponyc && ./jennet
